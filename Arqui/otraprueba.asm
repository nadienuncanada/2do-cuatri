DATO EQU 40H
ESTADO EQU 41H
INT0 EQU 24H
INT2 EQU 26H
IMR EQU 21H
EOI EQU 20H

ORG 20
DEAKI DW POLLING

ORG 40
DEACA DW RUT

ORG 3000H
RUT: MOV AL, 11111010B
OUT IMR,AL


POLLING: IN AL,ESTADO
OR AL,1
JZ POLLING

CMP DL,0
JZ FINNN

MOV AL,[BX]
OUT DATO,AL

INC BX
DEC DL
JMP RUT

FINNN: MOV AL,0FFH
OUT IMR,AL
MOV AL,20H
OUT EOI,AL

IRET

ORG 1000H
MSJ DB ""
FINMSJ DB ?
CAR DB ?
FINCAR DB ?
ORG 2000H

MOV BX,OFFSET MSJ
MOV AL,OFFSET FINMSJ-OFFSET MSJ
INT 7
MOV CL,3
MOV DL,0

MOV BX,OFFSET CAR
REP:INT 6
CMP BYTE PTR [BX],41H
JS REP
CMP BYTE PTR [BX],05BH
JNS REP
INC BX
INC DL
DEC CL
JNZ REP

CLI
;IMPRESORA,activar int(IMR),dejar estado ready(ESTADO),poner la direc para int2(INT2)
MOV AL,5
OUT INT2,AL

IN AL,ESTADO
OR AL,80H
OUT ESTADO,AL

;F10;ACTIVAR F10(IMR),CONFI INT0(INT0)

MOV AL,11111110B
OUT IMR,AL

MOV AL,10
OUT INT0,AL

STI

MOV BX,OFFSET CAR

LOOPEAR: CMP DL,0
JZ FINN
JMP LOOPEAR

FINN:INT 0
END
